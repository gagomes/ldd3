Extra code taken from http://www.cs.usfca.edu/~cruse/cs635f07/ Advanced Systems Programming
